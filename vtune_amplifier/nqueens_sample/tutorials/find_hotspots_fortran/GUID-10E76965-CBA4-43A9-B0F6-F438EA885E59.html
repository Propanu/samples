<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="DC.Type" content="topic" />
<meta name="DC.Title" content="Interpret Locks and Waits Results" />
<meta name="DC.Relation" scheme="URI" content="GUID-742F5949-4A88-4170-9A20-425DD0CFB029.html" />
<meta name="prodname" content="VTune Amplifier" />
<meta name="version" content="2016" />
<meta name="series" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-10E76965-CBA4-43A9-B0F6-F438EA885E59" />
<meta name="DC.Language" content="en-US" />
<link rel="stylesheet" type="text/css" href="intel_css_styles.css" />
<title>Interpret Locks and Waits Results</title>
<script src="resources/prism/prism.js"><!----></script>
<link href="resources/prism/prism.css" rel="stylesheet" />
</head>
<body id="GUID-10E76965-CBA4-43A9-B0F6-F438EA885E59">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; VTune&#8482; Amplifier</em></p>


<h1 class="topictitle1">Interpret Locks and Waits Results</h1>
<div><p><img id="IMAGE_1E1A2DDB919F49F98A28B474CCAB607C" src="GUID-02914B5D-1A7D-4B4B-8A24-9534BDA714E4-low.gif" /> When the sample application exits, the 
		<span>Intel&reg; VTune&#8482; Amplifier</span>
		finalizes the results and opens the Locks and Waits viewpoint that is
		configured to display synchronization objects sorted by Wait time. To interpret
		the data on the sample code performance, do the following: 
	 </p>
<ol id="GUID-D7826BA9-D37A-41A5-B0C1-E297171C7C56"><li id="LI_6D566E61019441F0A564CB54027CB620"><p><a href="#GUID-37FF6F69-92EB-46AD-9214-E61285B64160">Identify
				locks.</a></p>
</li>
<li id="LI_27902C191DBF4B32A0326FE7E402BEE8"><p><a href="#GUID-A25230C1-51E5-49AE-A4D5-DF9DF0F76375">Analyze
				source code.</a></p>
</li>
</ol>
<div class="section" id="GUID-37FF6F69-92EB-46AD-9214-E61285B64160"><h2 class="sectiontitle">Identify Locks</h2><p>Click the 
		  <strong>Bottom-up</strong> tab to open the 
		  <strong>Bottom-up</strong> pane. 
		</p>
<p><img id="IMAGE_CC6D6A44A36B44C79FAE4195BEC34CBE" src="GUID-762B7E6A-21BB-4D43-8732-5DC7C4649308-low.gif" /></p>
<p>The table below explains the type of data provided in the 
		  <strong>Bottom-up</strong> pane: 
		</p>

<div class="tablenoborder"><table cellpadding="4" summary="" id="GUID-63E651A8-3F31-4204-9531-EF7FB06D7E19" frame="void" border="0" rules="none" cellspacing="2"><tbody><tr><td class="noborder" valign="top" width="4.535147392290249%"><p id="GUID-78252E91-1B6F-4519-BAC8-B538A0F181E2"><img id="IMAGE_7500BB4277B34D4FAE637D1E7FC3C4C0" height="22" src="GUID-A4AF9F6D-C2F3-4CC2-BC62-4EF73CA76B7B-low.jpg" width="22" /></p>
</td>
<td class="noborder" valign="top" width="95.46485260770974%"><p id="GUID-F17834AE-FC2F-4A7D-A2A4-E0F733367BE8">Synchronization objects that
						control threads in the application. The hash (unique number) appended to some
						names of the objects identify the stack creating this synchronization object. 
					 </p>
</td>
</tr>
<tr><td class="noborder" valign="top" width="4.535147392290249%"><p id="GUID-A51AC04B-CF63-4E7F-8214-9942ECC82823"><img id="IMAGE_C94106C6FA0041158DE2A947CD194162" height="22" src="GUID-D8DBA40B-558C-4899-B9B6-9068F1CAE124-low.jpg" width="22" /></p>
</td>
<td class="noborder" valign="top" width="95.46485260770974%"><p id="GUID-66829A3B-DB80-4F7C-AB29-C20C3EFF3384">The
						utilization of the processor time when a given thread waited for some event to
						occur. By default, the synchronization objects are sorted by 
						<strong id="GUID-6B5D19AE-267B-4C0E-8797-E794C7A9928E">Poor</strong>
						processor utilization type. Bars showing OK or Ideal utilization (orange and
						green) are utilizing the processors well. You should focus your optimization
						efforts on functions with the longest poor CPU utilization (red 
						<img id="IMAGE_F26972A242BD45A389567F47769EA9E7" src="GUID-379CC698-B3D0-454F-B78C-DC5B4E22B37D-low.jpg" /> bars if the bar format is
						selected). Next, search for the longest over-utilized time (blue 
						<img id="IMAGE_6B1D91F256D64807A59949117ED37A82" height="13" src="GUID-D403605D-8D88-47E8-8654-3DF782D9C645-low.jpg" width="16" /> bars). 
					 </p>
<p id="GUID-FF846070-197A-411F-A094-9D5F46F2A119">This is the
						Data of Interest column for the Locks and Waits analysis results that is used
						for different types of calculations, for example: call stack contribution,
						percentage value on the filter toolbar. 
					 </p>
</td>
</tr>
<tr><td class="noborder" valign="top" width="4.535147392290249%"><p id="GUID-12377821-2AB6-47AC-B4C1-00886DA2F7C7"><img id="IMAGE_2E3C5AFF8D7D4A4082F91A421965F3ED" height="22" src="GUID-EC89F6F7-1D37-4D59-82B5-710853E15391-low.jpg" width="22" /></p>
</td>
<td class="noborder" valign="top" width="95.46485260770974%"><p id="GUID-544C28B4-41AB-41A7-B4CA-B8D92215CDD6">Number of
						times the corresponding system wait API was called. For a lock, it is the
						number of times the lock was contended and caused a wait. Usually you are
						recommended to focus your tuning efforts on the waits with both high Wait Time
						and Wait Count values, especially if they have poor utilization. 
					 </p>
</td>
</tr>
<tr><td class="noborder" valign="top" width="4.535147392290249%"><p><img id="IMAGE_5E538B1A8A324F0782344890BA683331" height="22" src="GUID-A41EFB53-22BA-4C1E-8F3F-EB18F05576FA-low.png" width="22" /></p>
</td>
<td class="noborder" valign="top" width="95.46485260770974%"><p>Wait time, during which the CPU is busy. This often occurs
						when a synchronization API causes the CPU to poll while the software thread is
						waiting. Some Spin time may be preferable to the alternative of the increased
						thread context switches. However, too much Spin time can reflect lost
						opportunity for productive work. 
					 </p>
</td>
</tr>
</tbody>
</table>
</div>
<p>In the 
		  <samp class="codeph">nqueens_parallel</samp> sample code, there are two critical
		  wait objects, 
		  <samp class="codeph">OMP Critical nqueens_IP_setqueen</samp> and 
		  <samp class="codeph">OMP Join
			 Barrier</samp>, that caused redundant synchronization and
		  took the longest Wait time and highest Wait count. The bar indicators in the 
		  <strong>Wait Time</strong> column indicate that most of the time for these
		  objects processor cores were 
		  <span>underutilized</span>. 
		</p>
</div>
<div class="section" id="GUID-A25230C1-51E5-49AE-A4D5-DF9DF0F76375"><h2 class="sectiontitle">Analyze Source Code</h2><p>Explore the source of the critical synchronization objects that caused
		  significant Wait time and poor processor utilization. Double-click the 
		  <samp class="codeph">nqueens_IP_setqueen</samp> object to analyze
		  the source of the 
		  <samp class="codeph">setqueen</samp> wait function. Click the 
		  <img id="IMAGE_9BA38701682E441A95F4C8C78FBA0C8B" src="GUID-5A0AFC44-F34C-4AE0-A245-3CC0DED4945A-low.jpg" /> button on the 
		  <strong>Source</strong> pane toolbar to go to the biggest hotspot code line in
		  the function. VTune Amplifier highlights line 142 protected by the OpenMP*
		  critical section. 
		</p>
<p><img id="IMAGE_5E89D86A13FA4D09AB86F982C2FAA0DB" src="GUID-78C62327-78E4-436A-8F51-84137223D9B5-low.gif" /></p>
<p>The 
		  <samp class="codeph">setqueen</samp> function was waiting for 
		  <span>140.687</span> seconds while this code line was
		  executing. During this time, this operation was contended 
		  <span>39,988</span> times. 
		</p>
<p>Hover over any transition line in the 
		  <strong>Timeline</strong> pane below to explore the infotip and make sure that
		  all the transitions are caused by the 
		  <samp class="codeph">OMP Critical nqueens_IP_setqueen</samp>
		  critical section. 
		</p>
<p><img id="IMAGE_06EFDFA436264AE28FF891F11CA003D9" src="GUID-B0B309D2-B1F5-48A3-A623-5A5EE8418B70-low.gif" /></p>
<p>The 
		  <samp class="codeph">OMP Critical nqueens_IP_setqueen</samp>
		  section is the place where the application is serializing. Each thread has to
		  wait for the critical section to be available before it can proceed. Only one
		  thread can be in the critical section at a time. 
		</p>
<p>You need to optimize the code to make it more concurrent. Click the 
		  <img id="IMAGE_AF31161C9E9741649DEA891917ABB5F7" src="GUID-5749422A-B37A-4FC0-9980-4B891EB19B67-low.gif" /><strong>Source Editor</strong> button on the 
		  <strong>Source</strong> window toolbar to open the code editor and optimize the
		  code. 
		</p>
</div>
<div class="section" id="GUID-0905CF5A-7204-4B0B-A0A1-B4470E95DAEA"><h2 class="sectiontitle">Key Terms </h2><ul id="GUID-52D7B502-A0A5-424B-A08D-152860ED0E35"><li id="GUID-68F28D45-CF3C-4F93-9FA5-2E789FA3825B"><p id="GUID-A0DA1B01-CB30-47CA-AF8C-0077071207FE"><a href="GUID-E9306A17-2C65-46CD-BE42-D8D94D0E336E.html#ELAPSED_TIME">Elapsed
				  time</a></p>
</li>
<li id="LI_DB26169CA7364FAEBFABAD294F2794D7"><p><a href="GUID-E9306A17-2C65-46CD-BE42-D8D94D0E336E.html#WAIT_TIME">Wait
				  time</a></p>
</li>
</ul>
</div>
<div class="section" id="GUID-EA3B5CA7-1D07-4FAF-8F42-1AC62A21B8B0"><h2 class="sectiontitle">Next Step</h2><p><a href="GUID-F44D6AB4-899A-48DC-9F0A-59E9BE98748F.html">Remove
			 Lock</a></p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-742F5949-4A88-4170-9A20-425DD0CFB029.html">Finding Hotspots</a></div>
</div>
<div></div>
</body>
</html>
